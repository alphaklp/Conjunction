
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Creating Search Result Repository Decorators Â· Conjunction</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-sunlight-highlighter/sunlight.default.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../faq/" />
    
    
    <link rel="prev" href="CreatingCustomProviders.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Read Me
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/">
            
                <a href="../introduction/">
            
                    
                    Introduction
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../introduction/Motivation.html">
            
                <a href="../introduction/Motivation.html">
            
                    
                    Motivation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../introduction/CoreConcepts.html">
            
                <a href="../introduction/CoreConcepts.html">
            
                    
                    Core Concepts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../introduction/Examples.html">
            
                <a href="../introduction/Examples.html">
            
                    
                    Examples
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../basics/">
            
                <a href="../basics/">
            
                    
                    Basics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../basics/CreateIndexableEntityModel.html">
            
                <a href="../basics/CreateIndexableEntityModel.html">
            
                    
                    Creating the Indexable Entity Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../basics/ConfigureSearchQuery.html">
            
                <a href="../basics/ConfigureSearchQuery.html">
            
                    
                    Configuring the Search Query
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../basics/RetrieveSearchResults.html">
            
                <a href="../basics/RetrieveSearchResults.html">
            
                    
                    Retrieving the Search Results
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="./">
            
                <a href="./">
            
                    
                    Advanced
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="NestedSearchQueries.html">
            
                <a href="NestedSearchQueries.html">
            
                    
                    Nested Search Queries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="CreatingCustomProviders.html">
            
                <a href="CreatingCustomProviders.html">
            
                    
                    Creating Custom Providers
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.3" data-path="CreatingSearchResultRepositoryDecorators.html">
            
                <a href="CreatingSearchResultRepositoryDecorators.html">
            
                    
                    Creating Search Result Repository Decorators
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../faq/">
            
                <a href="../faq/">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../Troubleshooting.html">
            
                <a href="../Troubleshooting.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../Glossary.html">
            
                <a href="../Glossary.html">
            
                    
                    Glossary
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../api/">
            
                <a href="../api/">
            
                    
                    API Reference
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../../CHANGELOG.html">
            
                <a href="../../CHANGELOG.html">
            
                    
                    Change Log
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Creating Search Result Repository Decorators</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="creating-search-result-repository-decorators">Creating Search Result Repository Decorators</h1>
<p>In this section, we&apos;ll be looking at how we can create search result repository decorators, thereby allowing behavior to be added to an default implementation, either statically or dynamically, without affecting the behavior of the default implementation.</p>
<h2 id="decorating-the-default-implementation-with-caching">Decorating the default implementation with caching</h2>
<p>The following example code shows how you can decorate the default search result repository to include caching:</p>
<pre><code class="lang-csharp"><span class="sunlight-csharp">&#xA0;&#xA0;<span class="sunlight-keyword">public</span>&#xA0;<span class="sunlight-keyword">class</span>&#xA0;<span class="sunlight-named-ident">CacheSearchResultRepositoryDecorator</span><span class="sunlight-operator">&lt;</span><span class="sunlight-ident">T</span><span class="sunlight-operator">&gt;</span>&#xA0;<span class="sunlight-operator">:</span>&#xA0;<span class="sunlight-named-ident">ISearchResultRepository</span><span class="sunlight-operator">&lt;</span><span class="sunlight-ident">T</span><span class="sunlight-operator">&gt;</span>
&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">where</span>&#xA0;<span class="sunlight-ident">T</span>&#xA0;<span class="sunlight-operator">:</span>&#xA0;<span class="sunlight-named-ident">IndexableEntity</span><span class="sunlight-punctuation">,</span>&#xA0;<span class="sunlight-keyword">new</span><span class="sunlight-punctuation">(</span><span class="sunlight-punctuation">)</span>
&#xA0;&#xA0;<span class="sunlight-punctuation">{</span>
&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">private</span>&#xA0;<span class="sunlight-keyword">const</span>&#xA0;<span class="sunlight-keyword">string</span>&#xA0;<span class="sunlight-ident">CacheItemName</span>&#xA0;<span class="sunlight-operator">=</span>&#xA0;<span class="sunlight-string">&quot;__CachedSearchResult__&quot;</span><span class="sunlight-punctuation">;</span>
&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">private</span>&#xA0;<span class="sunlight-keyword">const</span>&#xA0;<span class="sunlight-keyword">int</span>&#xA0;<span class="sunlight-ident">CacheTimeInMinutes</span>&#xA0;<span class="sunlight-operator">=</span>&#xA0;<span class="sunlight-number">5</span><span class="sunlight-punctuation">;</span>

&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">private</span>&#xA0;<span class="sunlight-keyword">readonly</span>&#xA0;<span class="sunlight-named-ident">ISearchResultRepository</span><span class="sunlight-operator">&lt;</span><span class="sunlight-ident">T</span><span class="sunlight-operator">&gt;</span>&#xA0;<span class="sunlight-ident">_searchResultRepository</span><span class="sunlight-punctuation">;</span>

&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">public</span>&#xA0;<span class="sunlight-named-ident">CacheSearchResultRepositoryDecorator</span><span class="sunlight-punctuation">(</span><span class="sunlight-named-ident">ISearchResultRepository</span><span class="sunlight-operator">&lt;</span><span class="sunlight-ident">T</span><span class="sunlight-operator">&gt;</span>&#xA0;<span class="sunlight-ident">searchResultRepository</span><span class="sunlight-punctuation">)</span>
&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-punctuation">{</span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-ident">_searchResultRepository</span>&#xA0;<span class="sunlight-operator">=</span>&#xA0;<span class="sunlight-ident">searchResultRepository</span><span class="sunlight-punctuation">;</span>
&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-punctuation">}</span>

&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">public</span>&#xA0;<span class="sunlight-named-ident">ISearchQueryElementProvider</span>&#xA0;<span class="sunlight-ident">SearchQueryElementProvider</span>&#xA0;<span class="sunlight-operator">=&gt;</span>&#xA0;<span class="sunlight-ident">_searchResultRepository</span><span class="sunlight-operator">.</span><span class="sunlight-ident">SearchQueryElementProvider</span><span class="sunlight-punctuation">;</span>

&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">public</span>&#xA0;<span class="sunlight-named-ident">IIndexNameProvider</span>&#xA0;<span class="sunlight-ident">IndexNameProvider</span>&#xA0;<span class="sunlight-operator">=&gt;</span>&#xA0;<span class="sunlight-ident">_searchResultRepository</span><span class="sunlight-operator">.</span><span class="sunlight-ident">IndexNameProvider</span><span class="sunlight-punctuation">;</span>

&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">public</span>&#xA0;<span class="sunlight-named-ident">ISearchQueryPredicateBuilder</span><span class="sunlight-operator">&lt;</span><span class="sunlight-ident">T</span><span class="sunlight-operator">&gt;</span>&#xA0;<span class="sunlight-ident">SearchQueryPredicateBuilder</span>&#xA0;<span class="sunlight-operator">=&gt;</span>&#xA0;<span class="sunlight-ident">_searchResultRepository</span><span class="sunlight-operator">.</span><span class="sunlight-ident">SearchQueryPredicateBuilder</span><span class="sunlight-punctuation">;</span>

&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">public</span>&#xA0;<span class="sunlight-named-ident">SearchResult</span><span class="sunlight-operator">&lt;</span><span class="sunlight-ident">T</span><span class="sunlight-operator">&gt;</span>&#xA0;<span class="sunlight-ident">GetSearchResult</span><span class="sunlight-punctuation">(</span><span class="sunlight-named-ident">SearchCriteria</span>&#xA0;<span class="sunlight-ident">searchCriteria</span><span class="sunlight-punctuation">)</span>
&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-punctuation">{</span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-named-ident">Func</span><span class="sunlight-operator">&lt;</span><span class="sunlight-named-ident">SearchResult</span><span class="sunlight-operator">&lt;</span><span class="sunlight-ident">T</span><span class="sunlight-operator">&gt;&gt;</span>&#xA0;<span class="sunlight-ident">getSearchResult</span>&#xA0;<span class="sunlight-operator">=</span>&#xA0;<span class="sunlight-punctuation">(</span><span class="sunlight-punctuation">)</span>&#xA0;<span class="sunlight-operator">=&gt;</span>&#xA0;<span class="sunlight-ident">_searchResultRepository</span><span class="sunlight-operator">.</span><span class="sunlight-ident">GetSearchResult</span><span class="sunlight-punctuation">(</span><span class="sunlight-ident">searchCriteria</span><span class="sunlight-punctuation">)</span><span class="sunlight-punctuation">;</span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">return</span>&#xA0;<span class="sunlight-ident">GetSearchResultFromCache</span><span class="sunlight-punctuation">(</span><span class="sunlight-ident">getSearchResult</span><span class="sunlight-punctuation">)</span><span class="sunlight-punctuation">;</span>
&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-punctuation">}</span>

&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">private</span>&#xA0;<span class="sunlight-named-ident">SearchResult</span><span class="sunlight-operator">&lt;</span><span class="sunlight-ident">T</span><span class="sunlight-operator">&gt;</span>&#xA0;<span class="sunlight-ident">GetSearchResultFromCache</span><span class="sunlight-punctuation">(</span><span class="sunlight-named-ident">Func</span><span class="sunlight-operator">&lt;</span><span class="sunlight-named-ident">SearchResult</span><span class="sunlight-operator">&lt;</span><span class="sunlight-ident">T</span><span class="sunlight-operator">&gt;&gt;</span>&#xA0;<span class="sunlight-ident">getSearchResult</span><span class="sunlight-punctuation">)</span>
&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-punctuation">{</span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-named-ident">ObjectCache</span>&#xA0;<span class="sunlight-ident">cache</span>&#xA0;<span class="sunlight-operator">=</span>&#xA0;<span class="sunlight-ident">MemoryCache</span><span class="sunlight-operator">.</span><span class="sunlight-ident">Default</span><span class="sunlight-punctuation">;</span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">var</span>&#xA0;<span class="sunlight-ident">cachedSearchResult</span>&#xA0;<span class="sunlight-operator">=</span>&#xA0;<span class="sunlight-punctuation">(</span><span class="sunlight-ident">SearchResult</span><span class="sunlight-operator">&lt;</span><span class="sunlight-ident">T</span><span class="sunlight-operator">&gt;</span><span class="sunlight-punctuation">)</span><span class="sunlight-ident">cache</span><span class="sunlight-punctuation">[</span><span class="sunlight-ident">CacheItemName</span><span class="sunlight-punctuation">]</span><span class="sunlight-punctuation">;</span>

&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">if</span>&#xA0;<span class="sunlight-punctuation">(</span><span class="sunlight-ident">cachedSearchResult</span>&#xA0;<span class="sunlight-operator">==</span>&#xA0;<span class="sunlight-keyword">null</span><span class="sunlight-punctuation">)</span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-punctuation">{</span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-named-ident">CacheItemPolicy</span>&#xA0;<span class="sunlight-ident">policy</span>&#xA0;<span class="sunlight-operator">=</span>&#xA0;<span class="sunlight-keyword">new</span>&#xA0;<span class="sunlight-named-ident">CacheItemPolicy</span><span class="sunlight-punctuation">(</span><span class="sunlight-punctuation">)</span><span class="sunlight-punctuation">;</span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-ident">policy</span><span class="sunlight-operator">.</span><span class="sunlight-ident">AbsoluteExpiration</span>&#xA0;<span class="sunlight-operator">=</span>&#xA0;<span class="sunlight-ident">DateTimeOffset</span><span class="sunlight-operator">.</span><span class="sunlight-ident">Now</span><span class="sunlight-operator">.</span><span class="sunlight-ident">AddMinutes</span><span class="sunlight-punctuation">(</span><span class="sunlight-ident">CacheTimeInMinutes</span><span class="sunlight-punctuation">)</span><span class="sunlight-punctuation">;</span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-ident">cachedSearchResult</span>&#xA0;<span class="sunlight-operator">=</span>&#xA0;<span class="sunlight-ident">getSearchResult</span><span class="sunlight-punctuation">(</span><span class="sunlight-punctuation">)</span><span class="sunlight-punctuation">;</span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-ident">cache</span><span class="sunlight-operator">.</span><span class="sunlight-ident">Set</span><span class="sunlight-punctuation">(</span><span class="sunlight-ident">CacheItemName</span><span class="sunlight-punctuation">,</span>&#xA0;<span class="sunlight-ident">cachedSearchResult</span><span class="sunlight-punctuation">,</span>&#xA0;<span class="sunlight-ident">policy</span><span class="sunlight-punctuation">)</span><span class="sunlight-punctuation">;</span>
&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-punctuation">}</span>

&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-keyword">return</span>&#xA0;<span class="sunlight-ident">cachedSearchResult</span><span class="sunlight-punctuation">;</span>
&#xA0;&#xA0;&#xA0;&#xA0;<span class="sunlight-punctuation">}</span>
&#xA0;&#xA0;<span class="sunlight-punctuation">}</span>
</span></code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="CreatingCustomProviders.html" class="navigation navigation-prev " aria-label="Previous page: Creating Custom Providers">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../faq/" class="navigation navigation-next " aria-label="Next page: FAQ">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Creating Search Result Repository Decorators","level":"1.4.3","depth":2,"next":{"title":"FAQ","level":"1.5","depth":1,"path":"docs/faq/README.md","ref":"docs/faq/README.md","articles":[]},"previous":{"title":"Creating Custom Providers","level":"1.4.2","depth":2,"path":"docs/advanced/CreatingCustomProviders.md","ref":"docs/advanced/CreatingCustomProviders.md","articles":[]},"dir":"ltr"},"config":{"plugins":["anchorjs","-highlight","sunlight-highlighter","github-edit"],"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"},"pluginsConfig":{"github-edit":{"repo":"soen/Conjunction","branch":"master"},"anchorjs":{},"sunlight-highlighter":{},"search":{},"lunr":{"ignoreSpecialCharacters":false,"maxIndexSize":1000000},"sharing":{"all":["facebook","google","twitter","weibo","instapaper"],"facebook":true,"google":false,"instapaper":false,"twitter":true,"vk":false,"weibo":false},"fontsettings":{"family":"sans","size":2,"theme":"white"},"theme-default":{"showLevel":false,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Conjunction","gitbook":">=3.2.1"},"file":{"path":"docs/advanced/CreatingSearchResultRepositoryDecorators.md","mtime":"2017-01-22T22:44:07.753Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-01-27T15:07:26.811Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.1/anchor.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-github-edit/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

